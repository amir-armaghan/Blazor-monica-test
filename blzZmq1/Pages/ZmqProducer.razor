@page "/zmqproducer"
@using blzZmq1.Services
@using Capnp.Rpc
@using Mas.Rpc
@inject IFileUpload fileUpload
@inject Services.AppData AppData
@inject Services.ZmqProducer RunProducer

<h3>Send ENV via ZMQ</h3>
    
    <button @onclick="CreateMassage">Send static files via ZMQ to ZMQ Server</button>
    <p class="fixwidth">@envContent</p>

@code {

   // IFileListEntry file;
    string envContent;
    //public static string sssdds = Services.ZmqProducer.RunProducer();

    async Task CreateMassage() // call ZmqProducer calss
    {
        //var envService = EnvClient.GetMain<Mas.Rpc.Monica.IEnv>();
        //env = await envService.Create("bla", "bli", "blo");

        string envContent = Services.ZmqProducer.RunProducer();
        //RunProducer();



        //push msg here...
        using (var producer = new PushSocket())
        {
            producer.Connect(AppData.ServerPushAddress + ":" + AppData.ServerPushPort);
            producer.SendFrame(envContent);
            System.Threading.Thread.Sleep(2000);
            producer.Disconnect(AppData.ServerPushAddress + ":" + AppData.ServerPushPort);
        }

    }

}
